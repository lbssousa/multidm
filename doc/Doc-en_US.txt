Here you can find some useful information about Multiseat package 

/usr/local/share/mdm/images/

This directory contains all images that are used at the first screens, where 
heads are configured.

    images:
        -keyboard.png: ask user to press Fn key (to configure keyboard, 
        associating it with a screen and subsequently, the mouse).
        -mouse.png: aks user to press left mouse button (associating with the 
        screen and keyboard).
        -reconfig.png: show when one head is killed. Ask the user to reconfig 
        the mouse and keyboard or keep the current configuration.
        -wait.png: display a message while configuring mice and keyoards.


***

/usr/local/share/mdm/include/

This directory is where include files are located. Include files are functions 
for: log registering, hardware detection, image selecting and showing, link 
creating, path defining, script translating and mdm system utilities.

***

/usr/local/share/mdm/include/mdm-debug.inc :

This file has two functions: WriteDebug and WriteLog.
Dependencies: none
___

Function WriteDebug:
 - has one mandatory argument and another optional one.
 - creates a debug file, writes onto it and also on the standard and the 
standard error output. This function is set off by default.

Local variables:

 DBG: /var/log/mdm/mdm.log
___

Function WriteLog:
 - simply writes on log files (described on mdm-path.inc).

Local variables:

 LOG: /var/log/mdm/mdm-sys.log

***

/usr/local/share/mdm/include/mdm-hardware.inc :

This include file has functions to hardware detecting.
Dependencies: mdm-paths.inc
              mdm-debug.inc
___

Function Keyboards:
 Discover available keyboards. This function has one optional argument, that 
 might be:
 "all" shows default information about keyboards;
 "event" shows only keyboard associated events.

Local variables:

 TYPE: if function parameter equals to zero, TYPE receives "all" value; 
 otherwise, it receives the value found in function parameter.

 ALL_PHYSICAL: contains all devices addresses.

 ALL_HANDLERS: contains device managers names.

 ALL_EVENTS: contains device events.

 ALL_NAMES: contains device names.

 AUX: contains a number to name keyboard events, case "all" parameter has been 
 passed.
___

Function Mice:
Discover available mice. This function has one optional argument, that might be: 

 "all" shows default information about mice;

 "event" shows only mouse associated events.

At the end, if no mice were found, consider serial as default. 

Local variables:

 TYPE: if function parameter equals to zero, TYPE receives "all" value; 
 otherwise, it receives the value found in function parameter.

 ALL_PHYSICAL: contains all devices addresses.

 ALL_HANDLERS: contains device managers names.

 ALL_EVENTS: contains device events.

 ALL_NAMES: contains device names.

 AUX: contains a number to name mouse events, case "all" parameter has been 
 passed.

 USED: contains number of events already used (only used when "event" parameter 
 is passed).
___

Function VideoCards: 
 Discover available videocards. It has one optional parameter, that might be: 
 "driver" returns driver name found for videocards installed.
 "bus" returns bus ids for videocards.
 "all" returns all available information.

This function prints on standard output videocard BUS address and video drivers 
available.
If no drivers were found for a device, it assumes VESA driver as default.

Local variables:

 TYPE: if function parameters are not equal to one, TYPE receives "all" value; 
 otherwise, it receives the value found in function parameter.

 ALL_DRIVERS: contains video drivers. For assigning any value to this variable, 
 discover program must be installed, discover is set by mdm-path.inc.

 ALL_BUS_IDS: list of videocards installed on computer.

 NUMS and SEC_NUMS: auxiliary variables to set decimal and hexadecimal numbers 
 used to write bus ids.
___

Function NumHeads:
 Consider the smaller value between mice, keyboards and videocards, then set it 
 as the number of available heads. The minor possible number is one (1).

***

/usr/local/share/mdm/include/mdm-images.inc:

This file has the necessary functions to show images for keyboard and mice 
configuring.
Dependencies: mdm-path.inc
              mdm-debug.inc

___

Function SetImage:
 Shows an image according to given parameters. It has two parameters, the first 
 one might be:
 "keyboard": shows press Fx image.
 "mouse": shows click mouse button image.
 "wait": shows wait image.
 "reconfig": shows press reconfiguration image (press ESC or ENTER).
 "free": clean temporary image files.

The second parameter is the seat number specification.

Local variables:

 FILES: auxiliary variable made to clean old image files.

 CONVERT_ARGS: contains arguments to convert, a program that writes messages on 
 images.

 TERMINAL: contains the seat number, which is the second parameter.

 KEYB_MSG1: contains the first part of keyboard message to be written.
 KEYB_MSG2: contains the second part of keyboard message to be written.
 KEYB_MSG3: contains the third part of keyboard message to be written.
 MOUSE_MSG1: contains the first part of mouse message to be written.
 MOUSE_MSG2: contains the second part of mouse message to be written.
 MOUSE_MSG3: contains the third part of mouse message to be written.
 RECONF_MSG1: contains the first part of reconfiguration message to be written.
 RECONF_MSG2: contains the second part of reconfiguration message to be written.
 RECONF_MSG3: contains the third part of reconfiguration message to be written.
 WAIT_MSG: contains the wait message to be written.

* Note: all this messages are intended to be translated (to as many languages as 
possible). 

***

/usr/local/share/mdm/include/mdm-links.inc:

This file is responsible for creating keyboards and mice symbolic links for 
each seat. This links will be used by Xephyr to associate each keyboard and 
mouse to a specific seat.
Dependencies: mdm-hardware.inc
              mdm-path.inc
              mdm-debug.inc
___

Function KeyboardLink:
 Associate a keyboard to a specific seat. It has a loop that listens key
presses from detected keyboards and create links between keyboards and screens.
To do so, it calls SetImage function to display configuration images available 
in /usr/share/mdm/images (provided by mdm-images.inc).

Parameters: seat number to associate a keyboard with.

Local variables:

 CREATED: true (1) if there is a symlink pointing to referred keyboard.
 
 TERMINAL: contains seat number to associate keyboard.
 
 LINK: will receive the containing files of /dev/input, that are symlinks to 
keyboards found (MdmKbd<number>).
 
 KEYB_EVENTS: contains keyboard input events, provided by mdm-hardware.inc.
 
 PRESSED: contains a value indicating with keyboard has been pressed.   
___

Function MouseLink:
  This function associates a mouse to a specific seat. As KeyboardLink, 
MouseLink also has a loop to detect mouse click. In this function there is 
another functionality that prevents two or more mice to click at the same time 
for a single screen.

Parameters: seat number to associate.

Local variables:

 CREATED: true (1) if there is a symlink pointing to referred mouse.
 
 TERMINAL: seat number to associate mouse  with.
 
 LINK: will receive the containing files of /dev/input, that are symlinks to 
mice found (MdmMouse<number>).
 
 LOCK: lock file to assign a mouse link to referred mouse.
 
 HAS_LOCK: variable to prevent two different mouse to click at the same time.
 
 MICE_EVENTS: contains mice input events, provided by mdm-hardware.inc

***

/usr/share/mdm/include/mdm-path.inc:

This file contains all directories, MDM filepaths, external filepaths and 
auxiliary systems for MDM's work.

Depends on: /usr/share/mdm/include/mdm-debug.inc
___

Function CreatePath:
 Verifies the existence of needed system directories. Case they do not exist, 
they are created here. A debug file is written, reporting function behavior.

***

/usr/share/mdm/include/mdm-util.inc:

MDM system utilities:

Function IsRoot:
 Checks if the user has superuser rights. It has no parameters.
___

Function CheckSystem:
 Checks if all needed programs are installed. No parameters.

Local variables:
 DEBUG_FILE: Contains the filename used to write logs on.
___

Function InitSystem:
 Checks if some essencial MDM routines execution variables have been set. Case 
they have not, they are set here with default values.
 Initiate Debug as off, sets Display Manager to gdm, calls functions CreatePath 
and CheckSystem.
___

Function MDMCopyright:
 Writes on screen Copyright messages.

***

/usr/share/mdm/include/mdm-xephyr.inc:

This file has needed functions to create symbolic links for keyboards and mice 
and to associate them with an only seat. Xephyr is the one that makes it 
possible.


Function CallXephyr:
 This function calls Xephyr, checking given parameters. After that, execute 
Xephyr normally, storing errors in a logfile and keeping process ID, for 
controlling purposes.
Dependencies: 
        mdm-path.inc
        mdm-debug.inc
